<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper  namespace="com.pj.auth.mapper.AuthMenuMapper">
	  <resultMap id="BaseResultMap" type="com.pj.auth.pojo.AuthMenu" >
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="name" property="name" jdbcType="VARCHAR" />
    <result column="img" property="img" jdbcType="VARCHAR" />
    <result column="href" property="href" jdbcType="VARCHAR" />
    <result column="fid" property="fid" jdbcType="INTEGER" />
    <result column="grade" property="grade" jdbcType="INTEGER" />
    <result column="auth" property="auth" jdbcType="INTEGER" />
    <result column="post" property="post" jdbcType="INTEGER" />
  </resultMap>
  <sql id="Base_Column_List" >
    id, name, img, href, fid, grade, auth, post
  </sql>
	 <select id="GetMenu" resultMap="BaseResultMap" parameterType="com.pj.auth.pojo.AuthMenu">
		select * from auth_menu
		where 1=1
		<if test="id != null">
			AND id= #{id}
		</if>
		<if test="name != null">
			AND name= #{name}
		</if>
		<if test="fid != null">
			AND fid= #{fid}
		</if>
		<if test="grade != null">
			AND grade= #{grade}
		</if>
		<if test="auth != null">
			AND auth= #{auth}
		</if>
		<if test="post != null">
			AND post= #{post}
		</if>
	</select>
	<select id="GetMenubyUserid" resultMap="BaseResultMap" parameterType="java.lang.Integer">
		select auth_menu.id,auth_menu.name,auth_menu.fid,auth_menu.post,COUNT(auth_user.menuid)  as Choice from auth_menu
		LEFT JOIN auth_user on auth_user.menuid=auth_menu.id and userid=#{userid}
		
		where 1=1
		<if test="grade != 0">
			AND grade= #{grade}
		</if>
		<if test="auth != 0">
			AND auth= #{auth}
		</if>
		GROUP BY auth_menu.id,auth_menu.name,auth_menu.fid,auth_menu.post
	</select>
</mapper>